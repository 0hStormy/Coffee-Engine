<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <canvas id="testCanv"></canvas>
    <script src="engine/DaveShade3.js"></script>
    <script>
        console.log(DaveShade);

        const daveShadeInstance = DaveShade.createInstance(document.getElementById("testCanv"));

        console.log(daveShadeInstance);

        const myVertShader = `
        attribute highp vec4 a_position;
        attribute highp vec4 a_color;
        attribute highp vec2 a_texCoord;

        varying highp vec4 v_color;
        varying highp vec2 v_texCoord;

        uniform highp mat4 u_transform;

        highp vec4 rotation(highp vec4 invec4) {
            return vec4(
            (invec4.y) * u_transform[1][0] + (invec4.x) * u_transform[1][1],
            (invec4.y) * u_transform[1][1] - (invec4.x) * u_transform[1][0],
            invec4.zw
            );
        }

        void main()
        {
            v_color = a_color;
            v_texCoord = a_texCoord;
            gl_Position = (rotation(a_position) + vec4(u_transform[0][2],u_transform[0][3],0,0)) * vec4(a_position.w * u_transform[0][0],a_position.w * u_transform[0][1],1,1) - vec4(0,0,1,0);
        }
        `;

        const myFragShader = `
        uniform sampler2D u_texture;

        varying highp vec2 v_texCoord;
        varying highp vec4 v_color;

        void main()
        {
            gl_FragColor = texture2D(u_texture, mod(v_texCoord,1.0)) * v_color;
            gl_FragColor.rgb *= gl_FragColor.a;
            if (gl_FragColor.a == 0.0) {
                discard;
            }
        }
        `;

        const createdShader = daveShadeInstance.createShader(myVertShader,myFragShader);

        console.log(createdShader);
    </script>
</body>
</html>